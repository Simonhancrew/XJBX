# 条件变量综述

条件变量为线程同步提供了另一种方式。互斥锁通过控制线程对数据的访问来实现同步，而条件变量根据数据的实际值进行同步。

如果没有条件变量，程序员需要让线程不断的轮询（可能在临界区）以检查是否满足条件。

这可能非常的消耗资源，因为线程将在此活动中持续忙碌。条件变量是一种无需轮询就可以实现相同目标的方法

条件变量总是和互斥锁配合使用。

使用条件变量的代表性顺序如下所示：

<table style="border-collapse:collapse;border-spacing:0" class="tg"><thead><tr><th style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;position:-webkit-sticky;position:sticky;text-align:left;top:-1px;vertical-align:top;will-change:transform;word-break:normal"><span style="font-weight:bold;font-style:normal">Main Thread</span><br>Declare and initialize global data/variables which require synchronization (such as "count")<br>Declare and initialize a condition variable object <br>Declare and initialize an associated mutex <br>Create threads A and B to do work</th><th style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;position:-webkit-sticky;position:sticky;text-align:left;top:-1px;vertical-align:top;will-change:transform;word-break:normal"></th></tr></thead><tbody><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal"><span style="font-weight:bold;font-style:normal">Thread A</span><br>Do work up to the point where a certain condition must occur (such as "count" must reach a specified value)<br>Lock associated mutex and check value of a global variable<br>Call <span style="font-weight:bold">pthread_cond_wait()</span> to perform a blocking wait for signal from Thread-B. Note that a call to <span style="font-weight:bold">pthread_cond_wait()</span> automatically and atomically unlocks the associated mutex variable so that it can be used by Thread-B.<br>When signalled, wake up. Mutex is automatically and atomically locked.<br>Explicitly unlock mutex<br>Continue</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal"><span style="font-weight:bold;font-style:normal">Thread B</span><br>Do work<br>Lock associated mutex<br>Change the value of the global variable that Thread-A is waiting upon. <br>Check value of the global Thread-A wait variable. If it fulfills the desired condition, signal Thread-A.<br>Unlock mutex. <br>Continue</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal"><span style="font-weight:bold;font-style:normal">Main Thread</span><br>Join / Continue</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal"></td></tr></tbody></table>

